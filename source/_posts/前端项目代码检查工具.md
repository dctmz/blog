---
title: 前端项目代码检查工具
tags: [lint, sonarLint, spellChecker]
categories: [前端开发]
date: 2021-12-21 15:03:00
---

本文介绍在项目开发所用到的代码检查工具

<!-- more -->

## 原因（为什么我们需要代码检查工具）
##### 1. 规范团队代码风格。
>每个团队或个人都会有自己的编码习惯和代码风格，为了便于后期维护和阅读，我们需要统一代码格式规范：
>- 空格，
>- 统一缩进
>- 命名规范
>- ...
##### 2. 避免开发中出现低级bug
>一些常见代码问题（例如手误引起的语法问题），如果在编译或运行前不能及时发现，代码中的语法问题会直接导致编译或运行时错误，影响开发效率和代码质量。
##### 3. 提高代码质量和开发效率

**************************************************************************************************************
## 开发常用的代码检查工具
#### ***SonarLint***
> Sonar 是一个代码质量管理的开源工具，它通过插件的形式能够识别常见的多种编程语言（例如Java, C#, PHP, Pythod等）代码质量问题。Sonar可以帮你分析出以下代码质量问题：
>
> 1.不遵循代码标准；
> 2.潜在的缺陷，比如空指针、bug；
> 3.代码重复；
> 4.注释率不足或过高；
> 5.糟糕的复杂度，比如if/循环嵌套太多、类/方法太大；
> 6.缺乏单元测试；
>
>在公司中，一般是把SonarQube部署在服务器端，当开发人员提交代码时，Jenkins触发SonarQube进行代码检查，开发人员根据代码检查结果进行问题修复。但是这样，开发人员往往只会关注被阻断的代码问题，对于Sonar提示的设计、性能方面的问题往往视而不见。
>
>SonarLint插件，可以在IDE(Intellij Idea、Eclipse)中嵌入，这样开发人员不仅能使用SonarLint中内置的代码检查规则进行代码检查，也可以连接到远端服务器拉取远端规则。有了它，我们就可以在编写代码的过程中根据SonarLint的提示编写高质量代码了。

***安装***
以 vscode 为例，在侧边栏找到扩展商店搜索 [SonarLint] 点击 install。安装完成之后重新加载编辑器。

***代码检查***
SonarLint插件安装后，就可以使用它对Idea中的项目进行代码检查了。SonarLint能够对单个文件、整个项目、从VCS（版本控制系统，比如git、svn等）拉取的被修改文件这3类进行检查。


**************************************************************************************************************

#### ***Code Spell Checker***
> Code Spell Checker 是VSCode一款检查语法规则的插件，能够帮助我们检查单词拼写是否出现错误，检查的规则遵循 camelCase （驼峰拼写法）。

***安装***
打开 vscode，在侧边栏找到扩展商店搜索 [code spell checker] 点击 install。安装完成之后重新加载编辑器。

***代码检查***
在编写代码的过程中，变量未遵循驼峰拼写法的规则时，则会在其下方出现波浪线警告。

**************************************************************************************************************

#### ***ESLint | Prettier***
>ESlint 高度可定制，不依赖与特定的编码约定，用户可以自由地启用或禁用各个编码约定。
>
> ESlint 会对我们的代码格式进行一些检测（比如分号、单双引号等），但是并不能完全统一代码风格，我们还需要一个工具Prettier。
>
>prettier 是校验代码格式化的工具。它并不关心你的语法是否正确，只关心你的代码格式，比如是否使用单引号，语句结尾是否使用分号等等，不仅可以用来检测 JavaScript 代码格式，还可以检测 vue 文件，react 文件。

***安装***
打开 vscode，在侧边栏找到扩展商店搜索 [eslint] 和 [prettier code formatter] 点击 install。安装完成之后重新加载编辑器。
```javascript 
  npm install eslint -D
  npm install eslint-config-prettier -D
```

***文件配置***
eslint安装之后，可以执行 ```eslint --init``` 来生成一个默认的配置文件 .eslintrc
ESlint支持6种格式的配置文件，其使用的优先级和说明如下：
- .eslintrc.js：模块定义，export的对象即为配置对象
- .eslintrc.yaml：yaml语法
- .eslintrc.yml：yaml语法
- .eslintrc.json：JSON语法
- .eslintrc：兼容yaml和JSON语法
- package.json： 在package.json的eslintConfig字段中定义

.eslintrc.json 文件示例：（[详细的配置项点击这里](https://cn.eslint.org/docs/user-guide/configuring)）

```json
{
  "parserOptions": {
    "ecmaVersion": 6,
    "sourceType": "module",
    "ecmaFeatures": {
      "jsx": true
    }
  },
  "rules": {
    "semi": "error"
  }
}
```

***命令行***
```javascript
// 指定配置文件
eslint --config ~/my-eslint.json file.js
// 关闭配置文件
eslint --no-eslintrc file.js
// 指定运行环境
eslint --env browser,node file.js
// 指定需要进行代码检查的文件后缀
eslint . --ext .js --ext .JSX
// 定义全局变量
eslint --global require,exports:true file.js
// 将stdin作为代码源，指定解析器
echo '3 ** 4' | eslint --stdin --parser-options=ecmaVersion:7
// 使用缓存，指定缓存文件位置
eslint "src/**/*.js" --cache --cache-location "/Users/user/.eslintcache/"
// 指定插件
eslint --plugin eslint-plugin-mocha file.js
// 关闭warning输出
eslint --quiet file.js
// 指定报告输出文件
eslint --output-file ./test/test.html
//修复部分问题
eslint --fix
```

***prettier配置***（[详细的配置项点击这里](https://prettier.io/docs/en/options.html)）
可以在 esLint 中添加 plugin 配置 prettier。比如：
```json
{
  plugins: ["prettier"],
  rules: {
    prettier/prettier: "error"
  }
}
```
也可以在项目中新建一个```.prettierrc.json```文件：
```json
{
  // 尾逗号
  "trailingComma": "es5",
  // 缩进长度
  "tabWidth": 4,
  // 代码末尾分号
  "semi": false,
  // 单引号
  "singleQuote": true,
  // 单行代码最大长度
  "printWidth": 100,
  // 对象字面量的括号
  "bracketSpacing": true,
  // 箭头函数参数加括号
  "arrowParens": "always",
}
```